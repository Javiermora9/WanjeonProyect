"use strict";

var _PathCipher = _interopRequireDefault(require("./PathCipher"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

test('both nameKey and nameTweak are need', function () {
  expect(function () {
    (0, _PathCipher["default"])();
  }).toThrowErrorMatchingSnapshot();
});
test('shoud encrypt/decrypt file name', function () {
  var cases = [['es785ret6k0hje8fkrqmu9fdus', 'Hallo World'], ['p0e52nreeaj0a5ea7s64m4j72s', '1'], ['p0e52nreeaj0a5ea7s64m4j72s/l42g6771hnv3an9cgc8cr2n1ng', '1/12'], ['p0e52nreeaj0a5ea7s64m4j72s/l42g6771hnv3an9cgc8cr2n1ng/qgm4avr35m5loi1th53ato71v0', '1/12/123']];
  var cipher = (0, _PathCipher["default"])({
    nameKey: new Uint8Array(32),
    nameTweak: new Uint8Array(16)
  });
  cases.forEach(function (item) {
    expect(cipher.decrypt(item[0])).toEqual(item[1]);
  });
  cases.forEach(function (item) {
    expect(cipher.encrypt(item[1])).toEqual(item[0]);
  });
});